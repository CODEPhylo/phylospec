moves = VectorMoves()
monitors = VectorMonitors()

alignment := readDiscreteCharacterData( file="hallo.nex" )
taxa := alignment.taxa()
a ~ dnFossilizedBirthDeath( originAge=20, lambda=10.0, mu=5.0, psi=1.0, taxa=taxa, rho=0.5 )
moves.append( mvNarrow( a ) )
moves.append( mvNNI( a ) )
moves.append( mvFNPR( a ) )
moves.append( mvSubtreeScale( a ) )
moves.append( mvNodeTimeSlideUniform( a ) )
moves.append( mvRootTimeScaleBactrian( a ) )
moves.append( mvTreeScale( a ) )
c ~ dnBirthDeath( lambda=10.0, mu=5.0, rootAge=20.0, taxa=taxa )
moves.append( mvNarrow( c ) )
moves.append( mvNNI( c ) )
moves.append( mvFNPR( c ) )
moves.append( mvSubtreeScale( c ) )
moves.append( mvNodeTimeSlideUniform( c ) )
moves.append( mvRootTimeScaleBactrian( c ) )
moves.append( mvTreeScale( c ) )
h ~ dnCoalescent( theta=200, taxa=a.taxa() )
moves.append( mvNarrow( h ) )
moves.append( mvNNI( h ) )
moves.append( mvFNPR( h ) )
moves.append( mvSubtreeScale( h ) )
moves.append( mvNodeTimeSlideUniform( h ) )
moves.append( mvRootTimeScaleBactrian( h ) )
moves.append( mvTreeScale( h ) )

monitors.append( mnModel( filename = "revTreeDistributions.log", printgen = 10 ) )
monitors.append( mnFile( filename = "revTreeDistributions.trees", printgen = 10 ) )
monitors.append( mnScreen( printgen = 10 ) )

mymodel = model( a, c, h )
mymcmc = mcmc( mymodel, monitors, moves )
mymcmc.run( generations=20000, tuningInterval=200 )

q()