moves = VectorMoves()
monitors = VectorMonitors()

alignment := readDiscreteCharacterData( file="hallo.nex" )
tree ~ dnCoalescent( theta=200, taxa=alignment.taxa() )
moves.append( mvNarrow( tree ) )
moves.append( mvNNI( tree ) )
moves.append( mvFNPR( tree ) )
moves.append( mvSubtreeScale( tree ) )
moves.append( mvNodeTimeSlideUniform( tree ) )
moves.append( mvRootTimeScaleBactrian( tree ) )
moves.append( mvTreeScale( tree ) )
q := fnJC( num_states=4 )
a ~ dnPhyloBrownianREML( tree=tree, branchRates=1.0 )
moves.append( mvVectorSingleElementSlide( a ) )
b ~ dnPhyloOrnsteinUhlenbeckREML( tree=tree, alpha=0.5, theta=2.0, sigma=1.0, rootStates=0.0 )
moves.append( mvVectorSingleElementSlide( b ) )
c ~ dnPhyloCTMC( tree=tree, Q=q )
d ~ dnPhyloCTMC( tree=tree, Q=q, siteRates=v( 0.1 ) )
e ~ dnPhyloCTMC( tree=tree, Q=q, branchRates=v( 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1 ) )
f ~ dnPhyloCTMC( tree=tree, Q=q, siteRates=v( 0.2 ), branchRates=v( 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1 ) )

monitors.append( mnModel( filename = "phyloDistributions.log", printgen = 10 ) )
monitors.append( mnFile( filename = "phyloDistributions.trees", printgen = 10 ) )
monitors.append( mnScreen( printgen = 10 ) )

mymodel = model( tree, a, b, c, d, e, f )
mymcmc = mcmc( mymodel, monitors, moves )
mymcmc.run( generations=20000, tuningInterval=200 )

q()